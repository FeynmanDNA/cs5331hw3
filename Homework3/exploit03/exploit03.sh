# Bug Category: Parameter Pollution

# The logic of the case03.php is: 
# 1. the user click the hyperlinked text to trigger a GET request on line36 of case03.php
# 2. the GET parameters are payee=alice and sum=10
# 3. the php script will process the payee and sum upon receiving the GET request
# 4. php script will check if the "sum" parameter is numeric, and if so deduct the "sum" from bankmoney
# 5. at line18 of case03.php, $bankMoney = $bankMoney - $clean_sum;
# 6. then echo back message to user

# Exploit: 
# Vulnerability: the security-critical validation logic is flawed. quantities of "sum" can be negative, 
# attacker can send GET request to earn money;
# also there is no proper check on the receipient, from/to â€“ arbitrary accounts

#!/bin/bash
python3 exploit03.py
