# Bug Category: DOM based XSS

# The logic of the case11.php is: 
# 1. the user input a score in the textfield at line15
# 2. the score parameter is send via GET request and the score GET param is appended to the URL
# 3. the score GET param is appended to the URL because the GET request to send to the current page address ($_SERVER["PHP_SELF"]) at line 14
# 4. score GET param value is read by javascript location.search at line 22
# 5. location.search substring is used as input for eval() to store the value to variable score
# 6. if variable score is greater than 8, display alert message to user
# NOTE: PHP htmlspecialchars() is used at line 14, this function converts
# special characters like <>&'" etc to HTML entites
# Note: Javascript substring(1) basically strips the "?" from the GET query string

# Exploit: 
# the dynamic code evalution eval() is taking input from the DOM, in this case,
# JavaScript is accessing location.search and feeding the value to eval()
# we can mix code into the "score" param, since we are getting eval() to execute code,
# we are already calling javascript, so the plan is to assign score = 1; then call alert
# alert(document.cookie) will display the flag

#!/bin/bash
python3 exploit11.py
